## 1 - Архитектурный стиль

Приложение **Splitflow** построено по архитектуре **Client-Server (SPA + REST API)**.

Чёткое разделение ответственности:

* **Frontend (Client):** Одностраничное приложение (SPA) на React. Отвечает за отображение, навигацию и состояние интерфейса.
* **Backend (Server):** Веб-сервис на .NET Core. Отвечает за бизнес-логику, безопасность, работу с данными и предоставление API.

## 2 - Слои (Layers)

Система разделена на 4 основных логических слоя (сверху вниз):

### L1 - Presentation Layer (Frontend / Client)

**Технологии:** React, Vite, CSS Modules.

**Ответственность:**
1. Компоненты UI (Канбан, Таблицы, Формы).
2. Управление состоянием (Context API / State).
3. Клиентская валидация данных.
4. Отправка HTTP-запросов (Fetch/Axios) к API.
5. **Особый модуль:** `SetupPage` (для инициализации подключения).

### L2 - API Layer (Controllers)

**Технологии:** ASP.NET Core Web API (`Controllers/*.cs`).

 **Ответственность:**
1. Прием HTTP-запросов (GET, POST, PUT, DELETE).
2. Валидация входящих DTO (`ModelState`).
3. Маршрутизация.
4. Преобразование исключений в HTTP-коды (200, 400, 404, 500).
5. Аутентификация (JWT Bearer) и Авторизация (Roles).

### L3 - Service / Business Layer (Application Logic)

**Технологии:** C# Classes (Services).

**Ответственность:**
1. Реализация бизнес-сценариев (Use Cases).
2. Логика динамического создания подключения.
3. Расчеты (например, статистика для Дэшборда).
4. Маппинг Entity <-> DTO.

### L4 - Infrastructure & Data Access Layer

**Технологии:** Entity Framework Core (Npgsql), PostgreSQL.

**Ответственность:**
1. `AppDbContext`: Конфигурация таблиц и связей.
2. `Migrations`: Управление схемой БД.
3. Прямое взаимодействие с СУБД PostgreSQL.
4. Хранение конфигурации подключения (`appsettings.json` или кастомный конфиг).

---

## 3 - Модули системы

Функциональное разбиение приложения на независимые блоки (Modules).

1.  **Auth Module (Аутентификация)**
	Вход по email/паролю, генерация JWT токена, проверка прав доступа.
2.  **Setup Module (Инициализация)**
	Проверка наличия БД, прием параметров подключения, тестовое соединение, первичный накат миграций (Code-First).
3.  **Task Management Module (Задачи)**
	CRUD операции над задачами, смена статусов (Drag-n-Drop логика на бэке), фильтрация по проектам.
4.  **Employee Registry (Сотрудники)**
	Список сотрудников, поиск, просмотр профиля, KPI.
5.  **Analytics Module (Дэшборд)**
	Агрегация данных (кол-во задач по статусам, загрузка проектов) для графиков.

---

## 4 - Правила зависимостей

Поток данных и зависимостей направлен **от внешних слоев к внутренним** (или сверху вниз в классической N-Tier архитектуре):

1.  **Frontend** знает только про структуру **DTO** (контракты API).
2.  **Controller** зависит от **Services** (или напрямую от DbContext в простых сценариях MVP).
3.  **Service** зависит от **Domain Models** и **DbContext**.
4.  **DbContext** зависит от **Domain Models** и конфигурации БД.
5.  **Domain Models** (Employee, TaskItem) - ни от кого не зависят (POCO классы).